<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gest√£o de Produtos</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/JsBarcode.all.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <img width="100px" src="{{ url_for('static', filename='Images/Logo_tabacaria.png') }}" alt="logo">
            <div>
                <h1>Gest√£o de Produtos</h1>
                <p style="color: #999; margin-top: 5px;">Sistema de Invent√°rio com C√≥digo de Barras</p>
            </div>
            <div class="header-status">
                <div class="status-item">
                    <div class="status-number" id="totalProducts">0</div>
                    <div class="status-label">Produtos</div>
                </div>
                <div class="status-item">
                    <div class="status-number" id="totalValue">R$ 0</div>
                    <div class="status-label">Valor Total</div>
                </div>
            </div>
            <div class="header-actions">
                <button class="btn btn-secondary" onclick="window.location.href='/registrar'">üì¶ Registrar</button>
                <button class="btn btn-secondary" onclick="window.location.href='/estoque'">üìã Estoque</button>
                <button class="btn btn-ghost" onclick="window.location.href='/fornecedor'">ü§ù Fornecedor</button>
            </div>
            <button id="fullscreenBtn" class="btn-secondary" onclick="toggleFullScreen()" style="margin-left:12px; padding:10px 14px;">‚õ∂ Tela Cheia</button>
        </div>

        <!-- Conte√∫do Principal -->
        <div class="main-content">
            <!-- Cadastro de Produtos -->
            <div class="panel">
                <h2>üìù Cadastro de Produto</h2>
                <div id="successMessage"></div>
                
                <div class="form-group">
                    <label>Nome do Produto *</label>
                    <input type="text" id="productName" placeholder="Ex: Camiseta Azul">
                </div>

                <div class="form-group">
                    <label>Descri√ß√£o</label>
                    <textarea id="productDescription" placeholder="Descreva o produto..." rows="3"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Pre√ßo (R$) *</label>
                        <input type="number" id="productPrice" placeholder="0.00" min="0" step="0.01">
                    </div>
                    <div class="form-group">
                        <label>Quantidade *</label>
                        <input type="number" id="productQuantity" placeholder="0" min="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Categoria</label>
                        <input type="text" id="productCategory" placeholder="Ex: Roupas">
                    </div>
                    <div class="form-group">
                        <label>Unidade de Medida *</label>
                        <select id="productUnit">
                            <option value="">Selecione...</option>
                            <option value="Unidade">Unidade</option>
                            <option value="Caixa">Caixa</option>
                            <option value="Pacote">Pacote</option>
                        </select>
                    </div>
                </div>

                <div class="btn-group">
                    <button id="addBtn" class="btn-primary" onclick="addProduct()">+ Adicionar</button>
                    <button class="btn-secondary" onclick="clearForm()">Limpar</button>
                </div>
            </div>

            <!-- Lista de Produtos -->
            <div class="panel">
                <h2>üìä Produtos Cadastrados</h2>
                <div class="form-group">
                    <!-- bot√£o fixo esquerdo-inferior -->
                    <button id="floatingFullscreen" class="btn-secondary" onclick="toggleFullScreen()" aria-label="Tela Cheia">‚õ∂</button>

                    <script src="{{ url_for('static', filename='js/common.js') }}"></script>
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/JsBarcode.all.min.js"></script>
                    <script src="{{ url_for('static', filename='js/sistema_products.js') }}"></script>
        }

        function updateFullScreenButton() {
            const btn = document.getElementById('fullscreenBtn');
            const floating = document.getElementById('floatingFullscreen');
            const doc = document;
            const isFull = !!(doc.fullscreenElement || doc.webkitFullscreenElement || doc.mozFullScreenElement || doc.msFullscreenElement);
            btn.textContent = isFull ? '‚§¢ Sair Tela Cheia' : '‚õ∂ Tela Cheia';
            if (floating) floating.textContent = isFull ? '‚§¢' : '‚õ∂';
        }

        // Eventos para atualizar o texto do bot√£o quando o estado de fullscreen mudar
        document.addEventListener('fullscreenchange', updateFullScreenButton);
        document.addEventListener('webkitfullscreenchange', updateFullScreenButton);
        document.addEventListener('mozfullscreenchange', updateFullScreenButton);
        document.addEventListener('MSFullscreenChange', updateFullScreenButton);

        // Inicializa ao carregar a p√°gina ‚Äî garante persist√™ncia vis√≠vel ap√≥s reload
        document.addEventListener('DOMContentLoaded', () => {
            // Recarrega lista a partir do localStorage (j√° carregado acima)
            renderProducts();
            updateStats();
            updateFullScreenButton();
        });
    </script>
</body>
</html>